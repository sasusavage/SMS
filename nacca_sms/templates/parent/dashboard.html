{% extends "layouts/dashboard.html" %}

{% block title %}Parent Portal - NaCCA SMS{% endblock %}

{% block breadcrumb %}
<nav class="breadcrumb">
    <span class="breadcrumb-current">Parent Portal</span>
</nav>
{% endblock %}

{% block content %}
<div class="page-header">
    <h1 class="page-title">Welcome, Parent</h1>
    <p class="page-subtitle">View your children's academic progress and fee status</p>
</div>

<!-- Children -->
<div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: var(--space-5);">
    {% for data in children %}
    {% set student = data.student %}
    <div class="card">
        <div style="height: 4px; background: linear-gradient(90deg, var(--primary-500), var(--primary-700));"></div>
        <div class="card-body">
            <div style="display: flex; align-items: center; gap: var(--space-3); margin-bottom: var(--space-4);">
                <div class="user-avatar" style="width: 48px; height: 48px;">
                    {{ student.first_name[0] }}{{ student.last_name[0] }}
                </div>
                <div>
                    <div style="font-weight: 600; font-size: var(--font-size-lg);">{{ student.full_name }}</div>
                    <div style="font-size: var(--font-size-sm); color: var(--slate-400);">
                        {% if data.enrollment %}{{ data.enrollment.class_.name }}{% else %}-{% endif %}
                    </div>
                </div>
            </div>

            {% if data.balance > 0 %}
            <div
                style="padding: var(--space-3); background: rgba(239, 68, 68, 0.1); border-radius: var(--radius-lg); margin-bottom: var(--space-4);">
                <div style="font-size: var(--font-size-sm); color: var(--error-500); font-weight: 500;">Outstanding Fees
                </div>
                <div style="font-size: var(--font-size-xl); font-weight: 700; color: var(--error-500);">GHS {{
                    "{:,.2f}".format(data.balance) }}</div>
            </div>
            {% else %}
            <div
                style="padding: var(--space-3); background: rgba(16, 185, 129, 0.1); border-radius: var(--radius-lg); margin-bottom: var(--space-4);">
                <div style="font-size: var(--font-size-sm); color: var(--success-500); font-weight: 500;">Fee Status
                </div>
                <div style="font-size: var(--font-size-lg); font-weight: 700; color: var(--success-500);">Paid in Full
                </div>
            </div>
            {% endif %}

            <div style="display: flex; gap: var(--space-2);">
                <a href="{{ url_for('parent.child_profile', id=student.id) }}" class="btn btn-secondary btn-sm"
                    style="flex: 1;">Profile</a>
                <a href="{{ url_for('parent.child_results', id=student.id) }}" class="btn btn-primary btn-sm"
                    style="flex: 1;">Results</a>
            </div>
        </div>
    </div>
    {% else %}
    <div class="card" style="grid-column: 1 / -1;">
        <div class="card-body" style="text-align: center; padding: var(--space-12); color: var(--slate-500);">
            <p>No children linked to your account. Please contact the school administration.</p>
        </div>
    </div>
    {% endfor %}
</div>
{% endblock %}